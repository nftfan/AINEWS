<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFTFANS NEWS</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #1f1f1f; /* dark mode background color */
        color: #888; /* grey text color */
        font-size: 14px; /* smaller font size */
        padding: 10px;
    }
    h1 {
        color: #fff; /* white text color */
    }
    p {
        margin-bottom: 5px;
    }
    .search-container {
        display: flex;
        flex-direction: column; /* Changed to column layout */
        margin-bottom: 10px;
    }
    .search-container input[type=text] {
        padding: 5px; /* smaller padding */
        font-size: 14px; /* smaller font size */
        border: 1px solid #ccc; /* border color */
        border-radius: 24px;
        width: 200px; /* smaller width */
        margin-bottom: 5px; /* Added margin bottom */
    }
    .search-container button {
        padding: 5px 10px; /* smaller padding */
        font-size: 14px; /* smaller font size */
        background-color: #4CAF50; /* green button color */
        color: white;
        border: none;
        border-radius: 24px;
        cursor: pointer;
        width: 100px; /* smaller width */
    }
    .search-container button:hover {
        background-color: #45a049; /* darker green button color on hover */
    }
    .loading-message {
        color: #00f; /* blue text color */
    }
    table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid #444; /* border color */
    }
    th, td {
        padding: 8px; /* smaller padding */
        border-bottom: 1px solid #444; /* border color */
        color: #888; /* grey text color */
    }
    th {
        background-color: #333; /* table header background color */
        color: #fff; /* table header text color */
    }
    tr:nth-child(even) {
        background-color: #2f2f2f; /* alternate row background color */
    }
    tr:hover {
        background-color: #3f3f3f; /* hover row background color */
    }
    @media screen and (max-width: 600px) {
        table {
            font-size: 12px; /* reduce font size for smaller screens */
        }
        th, td {
            padding: 5px; /* smaller padding */
        }
    }
    /* Add a custom style for links */
    a {
        text-decoration: none; /* Remove default underline */
        color: inherit; /* Inherit color from parent element */
    }

    a:hover {
        text-decoration: underline; /* Underline on hover */
        color: inherit; /* Inherit color from parent element */
    }
</style>
</head>
<body>

<h1>NFTFANS NEWS</h1>
<p>Please enter your search query:</p>
<div class="search-container">
    <input type="text" id="searchQuery" placeholder="Enter search query...">
    <button onclick="searchNews()">Search</button>
</div>
<p id="loadingMessage" class="loading-message"></p>

<table>
  <thead>
    <tr>
      <th>Image</th>
      <th>Title</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody id="news"></tbody>
</table>

<script>
    // Function to fetch RSS feed using proxy server
    function fetchRSS(url) {
        return fetch('https://api.allorigins.win/get?url=' + encodeURIComponent(url))
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Network response was not ok.');
            })
            .then(data => new window.DOMParser().parseFromString(data.contents, 'text/xml'))
            .catch(error => console.error('Error:', error));
    }

    // Function to calculate the time elapsed since the publication date
    function timeSince(date) {
        const seconds = Math.floor((new Date() - date) / 1000);
        const interval = Math.floor(seconds / 31536000);

        if (interval > 1) {
            return interval + " years ago";
        }
        const intervalMonths = Math.floor(seconds / 2592000);
        if (intervalMonths > 1) {
            return intervalMonths + " months ago";
        }
        const intervalDays = Math.floor(seconds / 86400);
        if (intervalDays > 1) {
            return intervalDays + " days ago";
        }
        const intervalHours = Math.floor(seconds / 3600);
        if (intervalHours > 1) {
            return intervalHours + " hours ago";
        }
        const intervalMinutes = Math.floor(seconds / 60);
        if (intervalMinutes > 1) {
            return intervalMinutes + " minutes ago";
        }
        return Math.floor(seconds) + " seconds ago";
    }

    // Function to search news based on user input
    function searchNews() {
        const searchQuery = document.getElementById('searchQuery').value;
        const rssURL = `https://news.google.com/rss/search?q=${encodeURIComponent(searchQuery)}&hl=en-US&gl=US&ceid=US%3Aen`;

        document.getElementById('loadingMessage').innerText = 'Please wait, searching for latest news...';

        fetchRSS(rssURL)
            .then(data => {
                const items = Array.from(data.querySelectorAll('item'));
                const newsTable = document.getElementById('news');
                newsTable.innerHTML = ''; // Clear existing table

                // Sort items by date
                items.sort((a, b) => {
                    const dateA = new Date(a.querySelector('pubDate').textContent);
                    const dateB = new Date(b.querySelector('pubDate').textContent);
                    return dateB - dateA;
                });

                items.forEach(item => {
                    const title = item.querySelector('title').textContent;
                    const pubDate = new Date(item.querySelector('pubDate').textContent);
                    const link = item.querySelector('link').textContent; // Retrieve link
                    const imageId = Math.floor(Math.random() * 1000); // Generate random image ID

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><img src="https://picsum.photos/50/50?random=${imageId}" alt="Random Image"></td>
                        <td><a href="${link}" target="_blank">${title}</a></td> <!-- Make title clickable with link -->
                        <td>${timeSince(pubDate)}</td> <!-- Display time elapsed instead of date -->
                    `;
                    newsTable.appendChild(row);
                });

                document.getElementById('loadingMessage').innerText = ''; // Clear loading message
            })
            .catch(error => console.error('Error:', error));
    }

    // Initial load: Load default news (artificial intelligence)
    searchNews();
</script>


</body>
</html>
